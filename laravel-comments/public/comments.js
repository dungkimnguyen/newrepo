!function(e,n){"object"==typeof exports&&"object"==typeof module?module.exports=n():"function"==typeof define&&define.amd?define([],n):"object"==typeof exports?exports.Comments=n():e.Comments=n()}(this,function(){return function(e){function n(i){if(t[i])return t[i].exports;var o=t[i]={i:i,l:!1,exports:{}};return e[i].call(o.exports,o,o.exports,n),o.l=!0,o.exports}var t={};return n.m=e,n.c=t,n.d=function(e,t,i){n.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:i})},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},n.p="",n(n.s=2)}({2:function(e,n,t){e.exports=t("xghT")},WzHq:function(e,n,t){"use strict";function i(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,t=o(window.location.search,"_escaped_fragment_");return+o(t?"#"+t:window.location.hash.replace("#!","#"),e,!0)||n}function o(e,n,t){n=n.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var i=new RegExp((t?"[\\#]":"[\\?&]")+n+"=([^&#]*)"),o=i.exec(e);return o?decodeURIComponent(o[1].replace(/\+/g," ")):void 0}n.a=i},Z27y:function(e,n,t){var i,o,r;!function(t){"use strict";function a(e,n,t){"addEventListener"in window?e.addEventListener(n,t,!1):"attachEvent"in window&&e.attachEvent("on"+n,t)}function c(e,n,t){"removeEventListener"in window?e.removeEventListener(n,t,!1):"detachEvent"in window&&e.detachEvent("on"+n,t)}function u(){var e,n=["moz","webkit","o","ms"];for(e=0;e<n.length&&!q;e+=1)q=window[n[e]+"RequestAnimationFrame"];q||f("setup","RequestAnimationFrame not supported")}function s(e){return U[e]?U[e].log:S}function f(e,n){m("log",e,n,s(e))}function l(e,n){m("info",e,n,s(e))}function d(e,n){m("warn",e,n,!0)}function m(e,n,t,i){!0===i&&window.console}function p(e){function n(){function e(){k(j),w(P)}t("Height"),t("Width"),x(e,j,"init")}function t(e){var n=Number(U[P]["max"+e]),t=Number(U[P]["min"+e]),i=e.toLowerCase(),o=Number(j[i]);f(P,"Checking "+i+" is in range "+t+"-"+n),o<t&&(o=t,f(P,"Set "+i+" to min value")),o>n&&(o=n,f(P,"Set "+i+" to max value")),j[i]=""+o}function i(e){return R.substr(R.indexOf(":")+N+e)}function o(e){f(P,"MessageCallback passed: {iframe: "+j.iframe.id+", message: "+e+"}"),z("messageCallback",{iframe:j.iframe,message:JSON.parse(e)}),f(P,"--")}function r(){var e=document.body.getBoundingClientRect(),n=j.iframe.getBoundingClientRect();return JSON.stringify({iframeHeight:n.height,iframeWidth:n.width,clientHeight:Math.max(document.documentElement.clientHeight,window.innerHeight||0),clientWidth:Math.max(document.documentElement.clientWidth,window.innerWidth||0),offsetTop:parseInt(n.top-e.top,10),offsetLeft:parseInt(n.left-e.left,10),scrollTop:window.pageYOffset,scrollLeft:window.pageXOffset})}function u(e,n){function t(){O("Send Page Info","pageInfo:"+r(),e,n)}E(t,32)}function s(){function e(e,i){function o(){U[t]?u(U[t].iframe,t):n()}["scroll","resize"].forEach(function(n){f(t,e+n+" listener for sendPageInfo"),i(window,n,o)})}function n(){e("Remove ",c)}var t=P;!function(){e("Add ",a)}(),U[t].stopPageInfo=n}function m(){U[P]&&U[P].stopPageInfo&&(U[P].stopPageInfo(),delete U[P].stopPageInfo)}function p(e){var n=e.getBoundingClientRect();return b(P),{x:Math.floor(Number(n.left)+Number(L.x)),y:Math.floor(Number(n.top)+Number(L.y))}}function C(e){var n=e?p(j.iframe):{x:0,y:0},t=function(){return{x:Number(j.width)+n.x,y:Number(j.height)+n.y}}();f(P,"Reposition requested from iFrame (offset x:"+n.x+" y:"+n.y+")"),window.top!==window.self?function(){window.parentIFrame?window.parentIFrame["scrollTo"+(e?"Offset":"")](t.x,t.y):d(P,"Unable to scroll to requested position, window.parentIFrame not found")}():function(){L=t,I(),f(P,"--")}()}function I(){!1!==z("scrollCallback",L)?w(P):y()}function M(e){var n=e.split("#")[1]||"",t=decodeURIComponent(n),i=document.getElementById(t)||document.getElementsByName(t)[0];i?function(){var e=p(i);f(P,"Moving to in page link (#"+n+") at x: "+e.x+" y: "+e.y),L={x:e.x,y:e.y},I(),f(P,"--")}():window.top!==window.self?function(){window.parentIFrame?window.parentIFrame.moveToAnchor(n):f(P,"In page link #"+n+" not found and window.parentIFrame not found")}():f(P,"In page link #"+n+" not found")}function z(e,n){return g(P,e,n)}function T(){U[P].firstRun=!1}var R=e.data,j={},P=null;"[iFrameResizerChild]Ready"===R?function(){for(var e in U)O("iFrame requested init",F(e),document.getElementById(e),e)}():function(){return A===(""+R).substr(0,H)&&R.substr(H).split(":")[0]in U}()?(j=function(){var e=R.substr(H).split(":");return{iframe:U[e[0]].iframe,id:e[0],height:e[1],width:e[2],type:e[3]}}(),P=V=j.id,clearTimeout(U[P].msgTimeout),!function(){var e=j.type in{true:1,false:1,undefined:1};return e&&f(P,"Ignoring init message from meta parent page"),e}()&&function(e){var n=!0;return U[e]||(n=!1,d(j.type+" No settings for "+e+". Message was: "+R)),n}(P)&&(f(P,"Received: "+R),function(){var e=!0;return null===j.iframe&&(d(P,"IFrame ("+j.id+") not found"),e=!1),e}()&&function(){var n=e.origin,t=U[P].checkOrigin;if(t&&""+n!="null"&&!function(){return t.constructor===Array?function(){var e=0,i=!1;for(f(P,"Checking connection is from allowed list of origins: "+t);e<t.length;e++)if(t[e]===n){i=!0;break}return i}():function(){var e=U[P].remoteHost;return f(P,"Checking connection is from: "+e),n===e}()}())throw new Error("Unexpected message received from: "+n+" for "+j.iframe.id+". Message was: "+e.data+". This error can be disabled by setting the checkOrigin: false option or by providing of array of trusted domains.");return!0}()&&function(){switch(U[P].firstRun&&T(),j.type){case"close":h(j.iframe);break;case"message":o(i(6));break;case"scrollTo":C(!1);break;case"scrollToOffset":C(!0);break;case"pageInfo":u(U[P].iframe,P),s();break;case"pageInfoStop":m();break;case"inPageLink":M(i(9));break;case"reset":v(j);break;case"init":n(),z("initCallback",j.iframe),z("resizedCallback",j);break;default:n(),z("resizedCallback",j)}}())):l(P,"Ignored: "+R)}function g(e,n,t){var i=null,o=null;if(U[e]){if("function"!=typeof(i=U[e][n]))throw new TypeError(n+" on iFrame["+e+"] is not a function");o=i(t)}return o}function h(e){var n=e.id;f(n,"Removing iFrame: "+n),e.parentNode&&e.parentNode.removeChild(e),g(n,"closedCallback",n),f(n,"--"),delete U[n]}function b(e){null===L&&(L={x:window.pageXOffset!==t?window.pageXOffset:document.documentElement.scrollLeft,y:window.pageYOffset!==t?window.pageYOffset:document.documentElement.scrollTop},f(e,"Get page position: "+L.x+","+L.y))}function w(e){null!==L&&(window.scrollTo(L.x,L.y),f(e,"Set page position: "+L.x+","+L.y),y())}function y(){L=null}function v(e){function n(){k(e),O("reset","reset",e.iframe,e.id)}f(e.id,"Size reset requested by "+("init"===e.type?"host page":"iFrame")),b(e.id),x(n,e,"reset")}function k(e){function n(n){e.iframe.style[n]=e[n]+"px",f(e.id,"IFrame ("+o+") "+n+" set to "+e[n]+"px")}function t(n){W||"0"!==e[n]||(W=!0,f(o,"Hidden iFrame detected, creating visibility listener"),I())}function i(e){n(e),t(e)}var o=e.iframe.id;U[o]&&(U[o].sizeHeight&&i("height"),U[o].sizeWidth&&i("width"))}function x(e,n,t){t!==n.type&&q?(f(n.id,"Requesting animation frame"),q(e)):e()}function O(e,n,t,i,o){function r(){var o=U[i].targetOrigin;f(i,"["+e+"] Sending msg to iframe["+i+"] ("+n+") targetOrigin: "+o),t.contentWindow.postMessage(A+n,o)}function a(){d(i,"["+e+"] IFrame("+i+") not found")}i=i||t.id,U[i]&&(function(){t&&"contentWindow"in t&&null!==t.contentWindow?r():a()}(),function(){function e(){d(i,"No response from iFrame. Check iFrameResizer.contentWindow.js has been loaded in iFrame")}o&&(U[i].msgTimeout=setTimeout(e,U[i].warningTimeout))}())}function F(e){return e+":"+U[e].bodyMarginV1+":"+U[e].sizeWidth+":"+U[e].log+":"+U[e].interval+":"+U[e].enablePublicMethods+":"+U[e].autoResize+":"+U[e].bodyMargin+":"+U[e].heightCalculationMethod+":"+U[e].bodyBackground+":"+U[e].bodyPadding+":"+U[e].tolerance+":"+U[e].inPageLinks+":"+U[e].resizeFrom+":"+U[e].widthCalculationMethod}function C(e,n){function i(){var e=n&&n.id||Y.id+P++;return null!==document.getElementById(e)&&(e+=P++),e}function o(){var n=U[s].firstRun,t=U[s].heightCalculationMethod in _;!n&&t&&v({iframe:e,height:0,width:0,type:"init"})}function r(e){if("object"!=typeof e)throw new TypeError("Options is not an object")}function c(e){for(var n in Y)Y.hasOwnProperty(n)&&(U[s][n]=e.hasOwnProperty(n)?e[n]:Y[n])}function u(e){return""===e||"file://"===e?"*":e}var s=function(t){return V=t,""===t&&(e.id=t=i(),S=(n||{}).log,V=t,f(t,"Added missing iframe ID: "+t+" ("+e.src+")")),t}(e.id);!function(){return s in U&&"iFrameResizer"in e}()?(function(n){n=n||{},U[s]={firstRun:!0,iframe:e,remoteHost:e.src.split("/").slice(0,3).join("/")},r(n),c(n),U[s].targetOrigin=!0===U[s].checkOrigin?u(U[s].remoteHost):"*"}(n),function(){switch(f(s,"IFrame scrolling "+(U[s].scrolling?"enabled":"disabled")+" for "+s),e.style.overflow=!1===U[s].scrolling?"hidden":"auto",U[s].scrolling){case!0:e.scrolling="yes";break;case!1:e.scrolling="no";break;default:e.scrolling=U[s].scrolling}}(),function(){function n(n){1/0!==U[s][n]&&0!==U[s][n]&&(e.style[n]=U[s][n]+"px",f(s,"Set "+n+" = "+U[s][n]+"px"))}function t(e){if(U[s]["min"+e]>U[s]["max"+e])throw new Error("Value for min"+e+" can not be greater than max"+e)}t("Height"),t("Width"),n("maxHeight"),n("minHeight"),n("maxWidth"),n("minWidth")}(),function(){"number"!=typeof U[s].bodyMargin&&"0"!==U[s].bodyMargin||(U[s].bodyMarginV1=U[s].bodyMargin,U[s].bodyMargin=U[s].bodyMargin+"px")}(),function(n){function i(){O("iFrame.onload",n,e,t,!0),o()}a(e,"load",i),O("init",n,e,t,!0)}(F(s)),function(){Function.prototype.bind&&(U[s].iframe.iFrameResizer={close:h.bind(null,U[s].iframe),resize:O.bind(null,"Window resize","resize",U[s].iframe),moveToAnchor:function(e){O("Move to anchor","moveToAnchor:"+e,U[s].iframe,s)},sendMessage:function(e){e=JSON.stringify(e),O("Send Message","message:"+e,U[s].iframe,s)}})}()):d(s,"Ignored iFrame, already setup.")}function E(e,n){null===B&&(B=setTimeout(function(){B=null,e()},n))}function I(){function e(){for(var e in U)!function(e){function n(n){return"0px"===U[e].iframe.style[n]}(function(e){return null!==e.offsetParent})(U[e].iframe)&&(n("height")||n("width"))&&O("Visibility change","resize",U[e].iframe,e)}(e)}function n(n){f("window","Mutation observed: "+n[0].target+" "+n[0].type),E(e,16)}var t=window.MutationObserver||window.WebKitMutationObserver;t&&function(){var e=document.querySelector("body"),i={attributes:!0,attributeOldValue:!1,characterData:!0,characterDataOldValue:!1,childList:!0,subtree:!0};new t(n).observe(e,i)}()}function M(e){function n(){T("Window "+e,"resize")}f("window","Trigger event: "+e),E(n,16)}function z(){function e(){T("Tab Visable","resize")}"hidden"!==document.visibilityState&&(f("document","Trigger event: Visiblity change"),E(e,16))}function T(e,n){for(var t in U)(function(e){return"parent"===U[e].resizeFrom&&U[e].autoResize&&!U[e].firstRun})(t)&&O(e,n,document.getElementById(t),t)}function R(){a(window,"message",p),a(window,"resize",function(){M("resize")}),a(document,"visibilitychange",z),a(document,"-webkit-visibilitychange",z),a(window,"focusin",function(){M("focus")}),a(window,"focus",function(){M("focus")})}function j(){function e(e,n){n&&(!function(){if(!n.tagName)throw new TypeError("Object is not a valid DOM element");if("IFRAME"!==n.tagName.toUpperCase())throw new TypeError("Expected <IFRAME> tag, found <"+n.tagName+">")}(),C(n,e),i.push(n))}function n(e){e&&e.enablePublicMethods&&d("enablePublicMethods option has been removed, public methods are now always available in the iFrame")}var i;return u(),R(),function(o,r){switch(i=[],n(o),typeof r){case"undefined":case"string":Array.prototype.forEach.call(document.querySelectorAll(r||"iframe"),e.bind(t,o));break;case"object":e(o,r);break;default:throw new TypeError("Unexpected data type ("+typeof r+")")}return i}}if("undefined"!=typeof window){var P=0,S=!1,W=!1,N="message".length,A="[iFrameSizer]",H=A.length,L=null,q=window.requestAnimationFrame,_={max:1,scroll:1,bodyScroll:1,documentElementScroll:1},U={},B=null,V="Host Page",Y={autoResize:!0,bodyBackground:null,bodyMargin:null,bodyMarginV1:8,bodyPadding:null,checkOrigin:!0,inPageLinks:!1,enablePublicMethods:!0,heightCalculationMethod:"bodyOffset",id:"iFrameResizer",interval:32,log:!1,maxHeight:1/0,maxWidth:1/0,minHeight:0,minWidth:0,resizeFrom:"parent",scrolling:!1,sizeHeight:!0,sizeWidth:!1,warningTimeout:5e3,tolerance:0,widthCalculationMethod:"scroll",closedCallback:function(){},initCallback:function(){},messageCallback:function(){d("MessageCallback function not defined")},resizedCallback:function(){},scrollCallback:function(){return!0}};window.jQuery&&function(e){e.fn?e.fn.iFrameResize||(e.fn.iFrameResize=function(e){function n(n,t){C(t,e)}return this.filter("iframe").each(n).end()}):l("","Unable to bind to jQuery, it is not fully loaded.")}(jQuery),o=[],i=j,(r="function"==typeof i?i.apply(n,o):i)!==t&&(e.exports=r)}}()},ZWYU:function(e,n,t){"use strict";function i(e){return Object.keys(e).map(function(n){var t=e[n];return void 0===t?"":null===t?o(n):o(n)+"="+o(t)}).filter(function(e){return e.length>0}).join("&")}n.a=i;var o=function(e){return encodeURIComponent(e).replace(/[!'()*]/g,function(e){return"%"+e.charCodeAt(0).toString(16).toUpperCase()})}},"e2/S":function(e,n,t){"use strict";var i=function(){function e(e,n,t,i){return e/=i,e--,-t*(e*e*e*e-1)+n}function n(e){for(var n=0,t=0;e;)n+=e.offsetTop,t+=e.offsetLeft,e=e.offsetParent;return{top:n,left:t}}function t(e,n){var t={};return Object.keys(e).forEach(function(n){t[n]=e[n]}),Object.keys(n).forEach(function(e){t[e]=n[e]}),t}function i(e){return e.replace(/([A-Z])/g,function(e){return"-"+e.toLowerCase()})}function o(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.options=t(a,n),this.easeFunctions=t({easeOutQuart:e},i)}function r(e,n){var t={};return Object.keys(n).forEach(function(n){var o=e.getAttribute("data-mt-"+i(n));o&&(t[n]=isNaN(o)?o:parseInt(o,10))}),t}var a={tolerance:0,duration:800,easing:"easeOutQuart",callback:function(){}};return o.prototype.registerTrigger=function(e,n){var i=this;if(e){var o=e.getAttribute("href")||e.getAttribute("data-target"),a=o&&"#"!==o?document.getElementById(o.substring(1)):0,c=t(this.options,r(e,this.options));"function"==typeof n&&(c.callback=n);var u=function(e){e.preventDefault(),i.move(a,c)};return e.addEventListener("click",u,!1),function(){return e.removeEventListener("click",u,!1)}}},o.prototype.move=function(e){var i=this,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(0===e||e){o=t(this.options,o);var r="number"==typeof e?e:n(e).top,a=window.pageYOffset;r-=o.tolerance;var c=r-a,u=null,s=void 0,f=function n(t){var f=window.pageYOffset;u||(u=t-1);var l=t-u;if(s&&(c>0&&s>f||c<0&&s<f))return o.callback(e);s=f;var d=i.easeFunctions[o.easing](l,a,c,o.duration);window.scroll(0,d),l<o.duration?window.requestAnimationFrame(n):(window.scroll(0,r),o.callback(e))};window.requestAnimationFrame(f)}},o.prototype.addEaseFunction=function(e,n){this.easeFunctions[e]=n},o}();e.exports=i},mCbk:function(e,n,t){"use strict";function i(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:200;a.move(e,{duration:n})}n.a=i;var o=t("e2/S"),r=t.n(o),a=new r.a},xghT:function(e,n,t){"use strict";function i(e,n){var t={};for(var i in e)n.indexOf(i)>=0||Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}function o(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var r=t("mCbk"),a=t("WzHq"),c=t("ZWYU"),u=t("Z27y"),s=t.n(u),f=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e},l=function(){function e(e,n){for(var t=0;t<n.length;t++){var i=n[t];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(n,t,i){return t&&e(n.prototype,t),i&&e(n,i),n}}(),d=function(){function e(n){var t=n.el,r=i(n,["el"]);o(this,e),this.el=t;var a={url:"/comments"};if(this.options=f({},a,r),"string"==typeof this.el&&(this.el=document.querySelector(this.el)),!this.el)throw new Error("[comments] Element not found.");this.el.innerHTML="",this.initSpinner(),this.initIframe()}return l(e,[{key:"initSpinner",value:function(){this.spinner=document.createElement("div"),this.spinner.classList.add("comments__spinner"),this.el.appendChild(this.spinner)}},{key:"initIframe",value:function(){var e=this;this.iframe=document.createElement("iframe"),this.iframe.scrolling="no",this.iframe.src=this.buildUrl(),this.iframe.classList.add("comments__iframe"),this.iframe.onload=function(){e.spinner.style.display="none",e.iframe.style.opacity=1},this.el.appendChild(this.iframe),s()({messageCallback:function(e){var n=e.iframe,t=e.message,i=t.type,o=t.position;"scroll"===i&&setTimeout(function(){Object(r.a)(o+(0===o?0:n.offsetTop))},50)}},this.iframe)}},{key:"buildUrl",value:function(){var e=this.options,n=e.data?"function"==typeof e.data?e.data():e.data:{},t=location.protocol+"//"+location.hostname+(location.port?":"+location.port:""),i=e.permalink||(location.origin||t)+location.pathname+location.search,o=f({},n,{permalink:i,order:e.order,page_id:e.pageId,per_page:e.perPage,page:Object(a.a)("page"),target:Object(a.a)("comment"),commentable_id:e.commentableId,commentable_type:e.commentableType});return e.url+(e.url.indexOf("?")>-1?"&":"?")+Object(c.a)(o)}}]),e}();n.default=d}})});
//# sourceMappingURL=comments.js.map